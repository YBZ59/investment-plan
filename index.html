<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment AI System - Technical Roadmap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0b1121;
            color: #e2e8f0;
            background-image: radial-gradient(circle at 50% 0%, #1e293b 0%, #0b1121 70%);
        }

        .gradient-text {
            background: linear-gradient(to right, #60a5fa, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: rgba(96, 165, 250, 0.4);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
            transform: translateY(-2px);
        }

        .tech-pill {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(148, 163, 184, 0.2);
            font-family: 'Courier New', monospace;
        }

        .step-connector {
            position: absolute;
            left: 24px;
            top: 40px;
            bottom: -40px;
            width: 2px;
            background: #334155;
            z-index: 0;
        }
        
        .last-step .step-connector { display: none; }

        .btn-toggle {
            transition: all 0.3s ease;
        }
        
        .btn-toggle.active {
            background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            border: none;
        }

        .btn-toggle.inactive {
            background-color: transparent;
            color: #94a3b8;
            border: 1px solid #334155;
        }
        
        .btn-toggle.inactive:hover {
            border-color: #64748b;
            color: #cbd5e1;
        }

        /* Special Buttons */
        .btn-r-native.active { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4); border: none; }
        .btn-ui-journey.active { background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%); color: white; box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4); border: none; }
        .btn-biz-process.active { background: linear-gradient(135deg, #6366f1 0%, #4338ca 100%); color: white; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4); border: none; }
        .btn-arch-comp.active { background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%); color: white; box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4); border: none; }
        .btn-cost.active { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4); border: none; }

        /* Animation classes */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Moving Packet Animation */
        @keyframes movePacket { 0% { left: 0%; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { left: 100%; opacity: 0; } }
        .flow-packet { position: absolute; top: -4px; width: 0; height: 0; border-top: 5px solid transparent; border-bottom: 5px solid transparent; border-left: 8px solid #60a5fa; background-color: transparent; z-index: 5; animation: movePacket 2s infinite linear; }
        .flow-packet.purple { border-left-color: #a855f7; }
        .flow-packet.green { border-left-color: #22c55e; }
        .flow-packet.indigo { border-left-color: #6366f1; }

        /* Flow Diagram Basics */
        .flow-arrow-container { display: flex; flex-direction: column; align-items: center; justify-content: center; min-width: 60px; padding: 0 5px; }
        .flow-line { height: 2px; background: #475569; width: 100%; position: relative; }
        .flow-line::after { content: ''; position: absolute; right: 0; top: -4px; border-top: 5px solid transparent; border-bottom: 5px solid transparent; border-left: 6px solid #475569; }
        .flow-action-label { font-size: 0.6rem; color: #60a5fa; background: #0f172a; padding: 2px 6px; border: 1px solid #334155; border-radius: 10px; margin-bottom: -9px; z-index: 20; white-space: nowrap; }

        /* UI Mock Elements */
        .app-window { background: #0f172a; border: 1px solid #334155; border-radius: 12px; overflow: hidden; display: flex; min-height: 600px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3); }
        .app-sidebar { width: 200px; background: #1e293b; border-right: 1px solid #334155; padding: 20px 10px; flex-shrink: 0; display: flex; flex-direction: column; }
        .app-nav-item { display: flex; align-items: center; gap: 10px; padding: 10px; color: #94a3b8; font-size: 0.8rem; border-radius: 6px; margin-bottom: 4px; cursor: pointer; transition: all 0.2s; }
        .app-nav-item:hover { background: rgba(51, 65, 85, 0.5); color: #cbd5e1; }
        .app-nav-item.active { background: #334155; color: #fff; font-weight: 600; border-left: 3px solid #38bdf8; }
        .app-content { flex-grow: 1; padding: 30px; background: radial-gradient(circle at 10% 10%, #1e293b 0%, #0f172a 100%); overflow-x: auto; position: relative; }

        /* Mock Table */
        .mock-table { width: 100%; font-size: 0.65rem; color: #cbd5e1; border-collapse: collapse; }
        .mock-table th { text-align: left; padding: 6px; border-bottom: 1px solid #475569; color: #64748b; }
        .mock-table td { padding: 6px; border-bottom: 1px solid #334155; vertical-align: middle; }
        .mock-table tr:hover { background: rgba(51, 65, 85, 0.3); }
        .mock-btn-sm { padding: 2px 6px; border-radius: 4px; font-size: 0.6rem; cursor: pointer; display: inline-block; margin-right: 4px; }
        .btn-green { background: rgba(16, 185, 129, 0.2); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.4); }
        .btn-blue { background: rgba(59, 130, 246, 0.2); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.4); }
        .btn-red { background: rgba(239, 68, 68, 0.2); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.4); }
        .btn-purple { background: rgba(147, 51, 234, 0.2); color: #c084fc; border: 1px solid rgba(147, 51, 234, 0.4); }

        /* Charts & Data Sheet */
        .pie-chart { width: 80px; height: 80px; border-radius: 50%; background: conic-gradient(#3b82f6 0% 70%, #10b981 70% 90%, #f59e0b 90% 100%); }
        .chart-bar { width: 12px; background: #3b82f6; border-radius: 2px 2px 0 0; margin: 0 4px; }
        .ds-table { width: 100%; border-collapse: collapse; font-size: 0.7rem; color: #e2e8f0; }
        .ds-table th { background: #1e293b; padding: 8px; text-align: left; border: 1px solid #334155; }
        .ds-table td { padding: 8px; border: 1px solid #334155; background: #0f172a; }
        .ds-cell-calc { color: #60a5fa; font-weight: 600; background: rgba(59, 130, 246, 0.1) !important; cursor: pointer; }
        .ds-cell-calc:hover { background: rgba(59, 130, 246, 0.3) !important; }
        .ds-cell-manual { color: #fff; }
        
        /* FIXED: DS Input styling to remove white background */
        .ds-input { 
            background-color: transparent !important; 
            border: 1px solid transparent; 
            color: #e2e8f0; 
            width: 100%; 
            outline: none;
        }
        .ds-input.editing { 
            border: 1px solid #3b82f6; 
            background-color: #1e293b !important; 
            padding: 2px; 
        }

        /* Flow Cards & Windows */
        .flow-card { background: #1e293b; border: 1px solid #475569; border-radius: 8px; padding: 10px; width: 130px; min-height: 90px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; position: relative; z-index: 10; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.3); }
        .flow-card-title { font-size: 0.65rem; color: #94a3b8; text-transform: uppercase; font-weight: 700; margin-bottom: 6px; letter-spacing: 0.5px; }
        .mock-window-sm { background: #0f172a; border: 1px solid #475569; border-radius: 6px; width: 100%; height: 100%; overflow: hidden; display: flex; flex-direction: column; }
        .mock-header-sm { background: #334155; height: 10px; border-bottom: 1px solid #475569; display: flex; align-items: center; padding: 0 4px; gap: 2px; }
        .mock-dot-sm { width: 3px; height: 3px; border-radius: 50%; background: #64748b; }
        
        /* Diff Animation */
        @keyframes slideRight { 0% { transform: translateX(-10px); opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { transform: translateX(10px); opacity: 0; } }
        @keyframes slideLeft { 0% { transform: translateX(10px); opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { transform: translateX(-10px); opacity: 0; } }
        .anim-diff-r { animation: slideRight 2s infinite ease-in-out; }
        .anim-diff-l { animation: slideLeft 2s infinite ease-in-out; }
        
        /* Diagram Connectors (Standard) */
        .diagram-node { position: relative; z-index: 10; transition: transform 0.2s; }
        .diagram-node:hover { transform: scale(1.05); }
        .h-line { height: 2px; background: #475569; flex-grow: 1; position: relative; }
        .h-line::after { content: ''; position: absolute; right: 0; top: -4px; width: 0; height: 0; border-top: 5px solid transparent; border-bottom: 5px solid transparent; border-left: 6px solid #475569; }
        .flow-arrow-down { width: 2px; height: 40px; background: #475569; margin: 5px 0; position: relative; }
        .flow-arrow-down::after { content: ''; position: absolute; left: -4px; bottom: 0; width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 6px solid #475569; }

    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <!-- Header -->
    <header class="max-w-6xl mx-auto mb-10 text-center relative">
        <!-- TOP LEFT LOGO -->
        <div class="absolute top-0 left-0 hidden md:block">
            <img src="logo.png" alt="MORE" class="h-10 w-auto object-contain" onerror="this.style.display='none'">
        </div>

        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-900/20 border border-blue-500/20 text-blue-300 text-xs font-semibold mb-4 tracking-wider uppercase">
            <span class="w-2 h-2 rounded-full bg-blue-400 animate-pulse"></span>
            System Architecture 1.0
        </div>
        <h1 class="text-4xl md:text-5xl font-bold mb-4 gradient-text">MORE Compliance Report Generator</h1>
        <p class="text-slate-400 max-w-2xl mx-auto text-lg">
            Automated Analysis of TASE & Treasury Regulations
        </p>

        <!-- View Toggles -->
        <div class="flex flex-wrap justify-center gap-4 mt-8">
            <button onclick="switchView('biz-process')" id="btn-biz-process" class="btn-toggle btn-biz-process active px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-cogs"></i> Business Process
            </button>
            <button onclick="switchView('ui-journey')" id="btn-ui-journey" class="btn-toggle btn-ui-journey inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-laptop-medical"></i> UI Journey
            </button>
            <button onclick="switchView('tech')" id="btn-tech" class="btn-toggle inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-server"></i> Technical Deep Dive
            </button>
            <button onclick="switchView('deployment')" id="btn-deployment" class="btn-toggle inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-server"></i> Deployment & Scale
            </button>
            <button onclick="switchView('risk')" id="btn-risk" class="btn-toggle inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-chart-line"></i> Risks & Mitigation
            </button>
            <button onclick="switchView('security')" id="btn-security" class="btn-toggle inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-shield-alt"></i> Security
            </button>
            <button onclick="switchView('cost')" id="btn-cost" class="btn-toggle btn-cost inactive px-6 py-3 rounded-xl font-semibold flex items-center gap-2">
                <i class="fas fa-coins"></i> Cost Analysis
            </button>
        </div>
    </header>

    <main class="max-w-6xl mx-auto relative min-h-[800px]">

        <!-- ========================================== -->
        <!-- BUSINESS PROCESS VIEW (E2E) - FIRST TAB    -->
        <!-- ========================================== -->
        <div id="view-biz-process" class="fade-in">
            <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-indigo-500">End-to-End Business Logic & Infrastructure</h2>
            <p class="text-slate-400 mb-8 max-w-3xl">Operational flow integrating Secure Access, Cloud Infrastructure, and Human Review.</p>

            <div class="w-full overflow-x-auto p-4 bg-slate-800/30 rounded-2xl border border-indigo-500/30">
                <!-- Tuned Width -->
                <div class="min-w-[900px] lg:min-w-0 lg:w-full flex items-center justify-between gap-2"> 

                    <!-- 1. AUTH LAYER -->
                    <div class="flex flex-col items-center gap-2">
                        <div class="bg-indigo-900/40 border border-indigo-400 p-3 rounded-xl text-center w-28 shadow-lg shadow-indigo-500/20 relative">
                            <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-500 text-white text-[8px] px-2 rounded font-bold uppercase">Security</div>
                            <i class="fas fa-fingerprint text-2xl text-indigo-300 mb-2"></i>
                            <div class="text-[10px] font-bold text-white">Auth Layer</div>
                            <div class="text-[8px] text-indigo-200 mt-1">Supabase</div>
                        </div>
                    </div>

                    <!-- Connector -->
                    <div class="flow-arrow-container min-w-[30px]">
                        <div class="flow-action-label text-[9px]">Valid</div>
                        <div class="flow-line"><div class="flow-packet indigo"></div></div>
                    </div>

                    <!-- 2. CLOUD INFRASTRUCTURE WRAPPER -->
                    <div class="border-2 border-dashed border-slate-600 rounded-2xl p-3 bg-slate-900/40 relative flex items-center gap-3">
                        <div class="absolute -top-3 left-6 bg-slate-700 text-slate-300 text-[9px] px-2 py-0.5 rounded font-bold border border-slate-500 uppercase">
                            <i class="fas fa-cloud mr-1"></i> Cloud (Railway)
                        </div>

                        <!-- Inputs -->
                        <div class="flex flex-col gap-2">
                            <div class="bg-slate-800 border border-slate-600 p-2 rounded-lg w-32 flex items-center gap-2">
                                <div class="text-xl text-blue-400"><i class="fas fa-file-upload"></i></div>
                                <div>
                                    <div class="text-[8px] text-slate-400 uppercase font-bold">Uploads</div>
                                    <div class="text-[9px] text-white">PDF, Excel</div>
                                </div>
                            </div>
                             <div class="bg-slate-800 border border-slate-600 p-2 rounded-lg w-32 flex items-center gap-2 opacity-70">
                                <div class="text-xl text-slate-500"><i class="fas fa-network-wired"></i></div>
                                <div>
                                    <div class="text-[8px] text-slate-500 uppercase font-bold">API</div>
                                    <div class="text-[9px] text-slate-400">Maya Integ.</div>
                                </div>
                            </div>
                        </div>

                        <!-- Internal Connector -->
                        <div class="flow-arrow-container min-w-[30px]">
                            <div class="flow-line"><div class="flow-packet indigo"></div></div>
                        </div>

                        <!-- Engine -->
                         <div class="bg-slate-800 border-2 border-indigo-500 rounded-xl p-3 text-center w-36 shadow-xl relative">
                            <i class="fas fa-cogs text-2xl text-indigo-400 mb-2 animate-spin-slow" style="animation-duration: 10s;"></i>
                            <h4 class="text-white font-bold text-xs">Compliance Core</h4>
                            <p class="text-[8px] text-slate-400 mt-1">AI Extraction + R Logic</p>
                        </div>
                    </div>

                    <!-- Connector -->
                    <div class="flow-arrow-container min-w-[30px]">
                        <div class="flow-action-label text-[9px]">Draft</div>
                        <div class="flow-line"><div class="flow-packet indigo" style="animation-delay: 0.5s"></div></div>
                    </div>

                    <!-- 3. HUMAN REVIEW -->
                    <div class="flex flex-col gap-3 relative">
                        <div class="absolute -top-6 left-1/2 -translate-x-1/2 text-[9px] text-yellow-400 font-bold uppercase tracking-widest">Portal</div>
                        
                        <div class="bg-yellow-900/20 border border-yellow-500/50 p-2 rounded-lg w-36">
                            <div class="flex items-center gap-2 mb-1">
                                <i class="fas fa-user-edit text-yellow-400 text-sm"></i>
                                <span class="text-[10px] font-bold text-white">Analyst</span>
                            </div>
                            <p class="text-[8px] text-slate-400">Amend & Regen</p>
                        </div>

                        <div class="bg-green-900/20 border border-green-500/50 p-2 rounded-lg w-36">
                            <div class="flex items-center gap-2 mb-1">
                                <i class="fas fa-user-check text-green-400 text-sm"></i>
                                <span class="text-[10px] font-bold text-white">Auditor</span>
                            </div>
                            <p class="text-[8px] text-slate-400">Validate</p>
                        </div>
                    </div>

                    <!-- Connector -->
                    <div class="flow-arrow-container min-w-[30px]">
                        <div class="flow-action-label text-[9px]">Sign</div>
                        <div class="flow-line"><div class="flow-packet green" style="animation-delay: 1s"></div></div>
                    </div>

                    <!-- 4. OUTPUT -->
                    <div class="bg-green-600 rounded-xl p-3 text-center w-28 shadow-lg shadow-green-500/20">
                        <i class="fas fa-file-signature text-white text-xl mb-1"></i>
                        <div class="text-white font-bold text-[10px]">Submission</div>
                        <div class="text-[8px] text-green-100 mt-1">Archive</div>
                    </div>

                </div>
            </div>
        </div>
        
        <!-- ========================================== -->
        <!-- UI JOURNEY VIEW (INTERACTIVE APP MOCK)     -->
        <!-- ========================================== -->
        <div id="view-ui-journey" class="hidden">
             <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-cyan-500">Interactive Application Walkthrough</h2>
             <p class="text-slate-400 mb-6 max-w-3xl">Click on the sidebar items in the preview below to see the user journey for each module.</p>
             <div class="app-window">
                 <div class="app-sidebar">
                     <div class="mb-8 px-2 flex items-center justify-center border-b border-slate-700 pb-6"><img src="logo.png" alt="MORE Investments" class="h-10 w-auto object-contain" onerror="this.style.display='none'"></div>
                     <div class="text-[10px] text-slate-500 uppercase font-bold mb-4 tracking-widest px-2">Navigation</div>
                     <div id="nav-dashboard" class="app-nav-item active" onclick="openUiPage('dashboard')"><i class="fas fa-home w-5"></i> Dashboard</div>
                     <div id="nav-regulations" class="app-nav-item" onclick="openUiPage('regulations')"><i class="fas fa-balance-scale w-5"></i> Regulations</div>
                     <div id="nav-templates" class="app-nav-item" onclick="openUiPage('templates')"><i class="fas fa-layer-group w-5"></i> Templates</div>
                     <div id="nav-datasheet" class="app-nav-item" onclick="openUiPage('datasheet')"><i class="fas fa-table w-5"></i> Data Sheets</div>
                     <div id="nav-reports" class="app-nav-item" onclick="openUiPage('reports')"><i class="fas fa-file-invoice w-5"></i> Reports</div>
                     <div id="nav-audit" class="app-nav-item" onclick="openUiPage('audit')"><i class="fas fa-history w-5"></i> Audit Logs</div>
                 </div>
                 <div class="app-content relative">
                     <!-- PAGE: DASHBOARD -->
                     <div id="ui-page-dashboard" class="fade-in">
                        <div class="flex justify-between items-end mb-6"><div><h3 class="text-2xl font-bold text-white">Welcome back, Admin</h3><p class="text-xs text-slate-400">System Status: <span class="text-green-400">Operational</span></p></div><button class="bg-blue-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-blue-500 transition shadow-lg shadow-blue-500/20" onclick="openUiPage('reports')"><i class="fas fa-plus mr-2"></i> New Report</button></div>
                        <div class="grid grid-cols-3 gap-4 mb-8">
                            <div class="bg-slate-800 p-4 rounded-xl border border-slate-700 hover:border-purple-500 cursor-pointer transition" onclick="openUiPage('templates')"><div class="text-slate-400 text-[10px] uppercase font-bold">Total Templates</div><div class="text-2xl text-white font-bold mt-1">44</div></div>
                            <div class="bg-slate-800 p-4 rounded-xl border border-slate-700 hover:border-blue-500 cursor-pointer transition" onclick="openUiPage('reports-month')"><div class="text-slate-400 text-[10px] uppercase font-bold">Reports this Month</div><div class="text-2xl text-white font-bold mt-1">12</div></div>
                            <div class="bg-slate-800 p-4 rounded-xl border border-slate-700 hover:border-yellow-500 cursor-pointer transition" onclick="openUiPage('audit-pending')"><div class="text-slate-400 text-[10px] uppercase font-bold">Pending Audit</div><div class="text-2xl text-yellow-400 font-bold mt-1">3</div></div>
                        </div>
                        <div class="grid grid-cols-2 gap-6 mb-8"><div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700 flex flex-col items-center justify-center"><h4 class="text-xs text-slate-400 mb-4 uppercase font-bold">Reports by Type</h4><div class="pie-chart mb-4"></div><div class="flex gap-4 text-[9px] text-slate-400"><span class="flex items-center gap-1"><div class="w-2 h-2 bg-blue-500 rounded-full"></div> ETF</span><span class="flex items-center gap-1"><div class="w-2 h-2 bg-green-500 rounded-full"></div> Mutual</span><span class="flex items-center gap-1"><div class="w-2 h-2 bg-yellow-500 rounded-full"></div> Bond</span></div></div><div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700 flex flex-col items-center justify-center"><h4 class="text-xs text-slate-400 mb-4 uppercase font-bold">Submission Volume (Weekly)</h4><div class="flex items-end h-20 gap-2"><div class="chart-bar" style="height: 30%;"></div><div class="chart-bar" style="height: 50%;"></div><div class="chart-bar" style="height: 80%;"></div><div class="chart-bar" style="height: 60%;"></div><div class="chart-bar" style="height: 90%;"></div><div class="chart-bar" style="height: 40%;"></div><div class="chart-bar" style="height: 70%;"></div></div></div></div>
                        <div class="grid grid-cols-3 gap-6"><div class="col-span-2 bg-slate-800/50 p-4 rounded-xl border border-slate-700"><h4 class="text-xs text-slate-300 font-bold uppercase mb-3">Recent Activity</h4><div class="space-y-3"><div class="flex items-start gap-3"><div class="w-2 h-2 bg-blue-500 rounded-full mt-1.5"></div><div><p class="text-xs text-slate-300"><strong>Analyst A</strong> submitted <em>Oct 2024 ETF Report</em>.</p><p class="text-[10px] text-slate-500">2 hours ago</p></div></div><div class="flex items-start gap-3"><div class="w-2 h-2 bg-purple-500 rounded-full mt-1.5"></div><div><p class="text-xs text-slate-300"><strong>Admin</strong> updated <em>Reg 12b</em> to version 1.2.</p><p class="text-[10px] text-slate-500">5 hours ago</p></div></div><div class="flex items-start gap-3"><div class="w-2 h-2 bg-green-500 rounded-full mt-1.5"></div><div><p class="text-xs text-slate-300"><strong>Analyst B</strong> created new template <em>Bond Yield Summary</em>.</p><p class="text-[10px] text-slate-500">Yesterday</p></div></div></div></div><div class="bg-slate-800/50 p-4 rounded-xl border border-slate-700"><h4 class="text-xs text-slate-300 font-bold uppercase mb-3">System Health</h4><div class="space-y-2"><div class="flex justify-between text-xs text-slate-400"><span>API Status</span><span class="text-green-400 font-bold">Online</span></div><div class="w-full bg-slate-700 h-1 rounded-full"><div class="bg-green-500 h-1 rounded-full w-full"></div></div><div class="flex justify-between text-xs text-slate-400 mt-2"><span>Database Load</span><span class="text-blue-400 font-bold">12%</span></div><div class="w-full bg-slate-700 h-1 rounded-full"><div class="bg-blue-500 h-1 rounded-full w-[12%]"></div></div><div class="flex justify-between text-xs text-slate-400 mt-2"><span>AI Token Usage</span><span class="text-yellow-400 font-bold">65%</span></div><div class="w-full bg-slate-700 h-1 rounded-full"><div class="bg-yellow-500 h-1 rounded-full w-[65%]"></div></div></div></div></div>
                     </div>
                     <!-- PAGE: TEMPLATES -->
                     <div id="ui-page-templates" class="hidden">
                        <div id="template-step-list"><div class="flex justify-between items-center mb-6"><h3 class="text-xl font-bold text-white">Template Library</h3><button onclick="startTemplateWizard()" class="bg-purple-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-purple-500 transition shadow-lg shadow-purple-500/20"><i class="fas fa-magic mr-2"></i> + New Template (AI)</button></div><div class="bg-slate-800 rounded-xl overflow-hidden mb-8 border border-slate-700"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th>Name</th><th>Data Source</th><th>Processed</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr><td class="font-bold text-white">ETF Monthly V1</td><td>ETF_Data_Master.xlsx</td><td><span class="text-green-400">100%</span></td><td><span class="text-green-400">● Active</span></td><td><span class="mock-btn-sm btn-blue">Edit</span><span class="mock-btn-sm btn-purple" onclick="toggleTemplateHistory()">History</span><span class="mock-btn-sm btn-green" onclick="alert('Viewing Document...')">View</span><span class="mock-btn-sm btn-green" onclick="startReportWizard()">Use</span></td></tr><tr id="draft-template-row"><td class="font-bold text-white">TASE Weekly Summary</td><td>TASE_Raw_Export.xlsx</td><td><span class="text-yellow-400">85%</span></td><td id="draft-status"><span class="text-yellow-400">● Draft</span></td><td id="draft-actions"><span class="mock-btn-sm btn-blue">Edit</span><span class="mock-btn-sm btn-purple" onclick="toggleTemplateHistory()">History</span><span class="mock-btn-sm btn-green" onclick="alert('Viewing Document...')">View</span><span class="mock-btn-sm btn-green bg-green-900/50 border-green-800 text-green-200" onclick="activateTemplate(this)">Activate</span></td></tr></tbody></table></div><div class="border border-purple-500/30 bg-purple-900/10 rounded-2xl p-6"><h4 class="text-purple-400 font-bold text-xs uppercase mb-4 tracking-widest text-center">Flow: Creating a New Template</h4><div class="flex items-start gap-0 overflow-x-auto pb-4 justify-center"><div class="flow-card"><div class="flow-card-title">1. Upload</div><div class="mock-window-sm h-12 w-20"><div class="mock-header-sm"></div><div class="text-[6px] text-slate-500 flex justify-center items-center h-full">PDF + Excel</div></div></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">System Reads</div><div class="flow-line"><div class="flow-packet purple"></div></div></div><div class="flow-card border-dashed border-purple-500/50 bg-purple-900/20"><div class="flow-card-title">2. AI Logic</div><i class="fas fa-cogs fa-spin text-purple-400 text-lg"></i><span class="text-[8px] text-purple-300 mt-1">Mapping Fields...</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Review Map</div><div class="flow-line"><div class="flow-packet purple" style="animation-delay: 0.5s"></div></div></div><div class="flow-card"><div class="flow-card-title">3. Save</div><i class="fas fa-save text-green-400 text-lg"></i><span class="text-[8px] text-slate-400 mt-1">Available in Library</span></div></div></div></div>
                        <div id="template-step-wizard" class="hidden flex flex-col items-center justify-center h-full pt-10"><div class="bg-slate-800 p-8 rounded-2xl border border-purple-500/50 max-w-lg w-full shadow-2xl relative"><button onclick="cancelTemplateWizard()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button><h3 class="text-xl font-bold text-white mb-6 text-center">New Template Wizard</h3><div id="wiz-upload" class="text-center"><div class="grid grid-cols-3 gap-4 mb-6"><div class="border-2 border-dashed border-slate-600 rounded-xl p-4 hover:border-purple-500 transition cursor-pointer"><i class="fas fa-file-contract text-2xl text-slate-500 mb-2"></i><p class="text-[10px] text-slate-400">Regulation PDF</p></div><div class="border-2 border-dashed border-slate-600 rounded-xl p-4 hover:border-purple-500 transition cursor-pointer"><i class="fas fa-table text-2xl text-slate-500 mb-2"></i><p class="text-[10px] text-slate-400">Data Sheet (Excel)</p></div><div class="border-2 border-dashed border-slate-600 rounded-xl p-4 hover:border-purple-500 transition cursor-pointer"><i class="fas fa-file-pdf text-2xl text-slate-500 mb-2"></i><p class="text-[10px] text-slate-400">Final Report PDF</p></div></div><button onclick="runAiAnalysis()" class="bg-purple-600 text-white px-6 py-2 rounded-lg text-sm w-full">Start Reverse Engineering</button></div><div id="wiz-processing" class="hidden text-center py-6"><i class="fas fa-circle-notch fa-spin text-4xl text-purple-400 mb-4"></i><h4 class="text-white font-bold">AI Processing...</h4><div class="w-full bg-slate-700 h-2 rounded-full mt-4 mb-2 overflow-hidden"><div id="ai-progress-bar" class="bg-purple-500 h-full w-0 transition-all duration-[2000ms] ease-out"></div></div><p class="text-xs text-slate-400">Analyzing Structure & Formulas...</p></div><div id="wiz-success" class="hidden text-center"><div class="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4"><i class="fas fa-check text-green-400 text-3xl"></i></div><h4 class="text-white font-bold text-lg">Analysis Complete</h4><p class="text-xs text-slate-400 mt-1 mb-2">Successfully mapped <strong>45 fields</strong>.</p><div class="bg-slate-900 p-3 rounded mb-6 border border-green-500/30"><div class="flex justify-between text-xs mb-1"><span class="text-slate-400">Mapping Confidence:</span><span class="text-green-400 font-bold">85%</span></div><div class="w-full bg-slate-700 h-1.5 rounded-full"><div class="bg-green-500 h-1.5 rounded-full w-[85%]"></div></div></div><button onclick="finishTemplateWizard()" class="bg-green-600 text-white px-6 py-2 rounded-lg text-sm w-full">Save Template to Library</button></div></div></div>
                        <div id="template-history-modal" class="hidden absolute top-0 left-0 w-full h-full bg-black/80 flex items-center justify-center z-50"><div class="bg-slate-800 p-6 rounded-xl border border-slate-600 w-96 relative shadow-2xl"><button onclick="toggleTemplateHistory()" class="absolute top-3 right-3 text-slate-400 hover:text-white"><i class="fas fa-times"></i></button><h4 class="text-white font-bold mb-4">Change Log: TASE Weekly</h4><div class="space-y-3 text-xs text-slate-300"><div class="flex justify-between border-b border-slate-700 pb-2"><span><span class="text-green-400">Created</span> by Admin</span><span class="text-slate-500">2024-10-24 09:30</span></div><div class="flex justify-between border-b border-slate-700 pb-2"><span><span class="text-blue-400">Mapping Edit</span> by User B</span><span class="text-slate-500">2024-10-24 11:15</span></div><div class="flex justify-between border-b border-slate-700 pb-2"><span><span class="text-purple-400">Formula Update</span> by Admin</span><span class="text-slate-500">2024-10-25 14:00</span></div></div></div></div>
                     </div>

                     <!-- PAGE: REPORTS -->
                     <div id="ui-page-reports" class="hidden">
                        <div id="report-step-list"><div class="flex justify-between items-center mb-6"><h3 class="text-xl font-bold text-white">Generated Reports</h3><div class="flex gap-2"><input type="text" placeholder="Search..." class="bg-slate-800 border border-slate-600 rounded px-3 py-1 text-xs text-white w-40"><button onclick="startReportWizard()" class="bg-green-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-green-500 transition shadow-lg shadow-green-500/20"><i class="fas fa-plus mr-2"></i> Generate New</button></div></div><div class="bg-slate-800 rounded-xl overflow-hidden mb-8 border border-slate-700"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th>Report Name</th><th>Status</th><th>Author</th><th>Actions</th></tr></thead><tbody><tr><td class="font-bold text-white">Oct 2024 ETF Report</td><td><span class="text-yellow-400 text-[9px] border border-yellow-500 px-1 rounded">Draft</span></td><td>Analyst A</td><td><span class="mock-btn-sm btn-blue">Edit</span><span class="mock-btn-sm btn-red">Delete</span></td></tr><tr><td class="font-bold text-white">Q3 Summary</td><td><span class="text-green-400 text-[9px] border border-green-500 px-1 rounded">Submitted</span></td><td>Analyst B</td><td><span class="mock-btn-sm btn-green">View</span><span class="mock-btn-sm btn-blue">Diff</span></td></tr></tbody></table></div><div class="border border-green-500/30 bg-green-900/10 rounded-2xl p-6"><h4 class="text-green-400 font-bold text-xs uppercase mb-4 tracking-widest text-center">Flow: Generating a Report</h4><div class="flex items-start gap-0 overflow-x-auto pb-4 justify-center"><div class="flow-card"><div class="flow-card-title">1. Select</div><div class="text-[8px] text-slate-400">Pick "ETF Monthly"</div></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Load Data Sheet</div><div class="flow-line"><div class="flow-packet green"></div></div></div><div class="flow-card w-40 border-yellow-500/50"><div class="flow-card-title text-yellow-400">2. Data Editor</div><div class="mock-window-sm h-10 w-full border-yellow-500/30 bg-slate-900"><div class="mock-header-sm bg-yellow-900/40"></div><div class="grid grid-cols-3 gap-0.5 p-0.5"><div class="bg-slate-700 h-2"></div><div class="bg-yellow-500/20 h-2"></div><div class="bg-slate-700 h-2"></div></div></div><span class="text-[8px] text-slate-400 mt-1">Manual updates only</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Run & Calc</div><div class="flow-line"><div class="flow-packet green" style="animation-delay: 0.5s"></div></div></div><div class="flow-card"><div class="flow-card-title">3. Audit</div><i class="fas fa-search-dollar text-green-400 text-lg"></i><span class="text-[8px] text-slate-400 mt-1">Verify Output</span></div></div></div></div>
                        <div id="report-step-wizard" class="hidden flex flex-col items-center justify-center h-full pt-4"><div class="bg-slate-800 p-6 rounded-2xl border border-green-500/50 max-w-2xl w-full shadow-2xl relative"><button onclick="cancelReportWizard()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button><div class="grid grid-cols-2 gap-6 h-full"><div class="border-r border-slate-700 pr-4"><h3 class="text-lg font-bold text-white mb-4">New Report</h3><div class="space-y-4"><div class="text-xs text-green-400 font-bold">1. Select Template</div><div class="text-xs text-slate-500">2. Data Editor</div><div class="text-xs text-slate-500">3. Review & Audit</div></div></div><div><label class="text-xs text-slate-400 block mb-2">Choose Template:</label><select class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-xs text-white mb-4"><option>ETF Monthly V1</option><option>TASE Weekly</option></select><label class="text-xs text-slate-400 block mb-2">Select Data Source:</label><select class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-xs text-white mb-6"><option>ETF_Data_Master.xlsx (Latest)</option><option>ETF_Data_Master_v2.xlsx</option></select><button onclick="finishReportWizard()" class="bg-green-600 text-white w-full py-2 rounded text-xs font-bold">Launch Data Editor</button></div></div></div></div>
                     </div>

                     <!-- PAGE: AUDIT LOGS -->
                     <div id="ui-page-audit" class="hidden">
                        <h3 class="text-xl font-bold text-white mb-6">Audit History</h3>
                        <div class="bg-slate-900 p-4 rounded-xl border border-slate-700 font-mono text-xs text-slate-400 h-64 overflow-y-auto"><div class="mb-2"><span class="text-slate-500">[10:05 AM]</span> User <strong>Analyst_A</strong> updated "Cash Flow" in <em>Oct Report</em> from <span class="text-red-400">1.2M</span> to <span class="text-green-400">1.5M</span>.</div><div class="mb-2"><span class="text-slate-500">[09:30 AM]</span> User <strong>Admin</strong> created new template "Bond Summary V2".</div><div class="mb-2"><span class="text-slate-500">[Yesterday]</span> System generated "Q3 Summary" (Success).</div></div>
                     </div>
                     
                     <!-- PAGE: REGULATIONS -->
                     <div id="ui-page-regulations" class="hidden">
                        <div id="reg-list-view"><div class="flex justify-between items-center mb-6"><h3 class="text-xl font-bold text-white">Regulatory Documents</h3><div class="flex gap-2"><input type="text" placeholder="Search Docs..." class="bg-slate-800 border border-slate-600 rounded px-3 py-1 text-xs text-white w-40"><button onclick="startRegUpload()" class="bg-blue-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-blue-500 transition shadow-lg shadow-blue-500/20"><i class="fas fa-upload mr-2"></i> Upload New</button></div></div><div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th>Document Name</th><th>Current Version</th><th>Effective Date</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr><td class="font-bold text-white"><i class="fas fa-file-pdf text-red-500 mr-2"></i> Capital Adequacy 12b</td><td>v1.0</td><td>2024-01-01</td><td><span class="text-green-400">● Active</span></td><td><span class="mock-btn-sm btn-blue" onclick="alert('Opening PDF Viewer...')">View</span><span class="mock-btn-sm btn-purple" onclick="openRegHistory('Capital Adequacy 12b')">History</span></td></tr><tr><td class="font-bold text-white"><i class="fas fa-file-pdf text-red-500 mr-2"></i> TASE Listing Rules</td><td>v2.4</td><td>2023-11-15</td><td><span class="text-green-400">● Active</span></td><td><span class="mock-btn-sm btn-blue" onclick="alert('Opening PDF Viewer...')">View</span><span class="mock-btn-sm btn-purple" onclick="openRegHistory('TASE Listing Rules')">History</span></td></tr></tbody></table></div><div class="border border-purple-500/30 bg-purple-900/10 rounded-2xl p-6 mt-8"><h4 class="text-purple-400 font-bold text-xs uppercase mb-4 tracking-widest text-center">Flow: Regulation Update Cycle</h4><div class="flex items-start gap-0 overflow-x-auto pb-4 justify-center"><div class="flow-card"><div class="flow-card-title">1. ISA</div><i class="fas fa-university text-slate-400 text-2xl my-2"></i><span class="text-[8px] text-slate-500">Issues New Reg</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Publishes</div><div class="flow-line"><div class="flow-packet purple"></div></div></div><div class="flow-card"><div class="flow-card-title">2. Ingest</div><i class="fas fa-cloud-upload-alt text-purple-400 text-2xl my-2"></i><span class="text-[8px] text-slate-400">PDF Upload</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">AI Processing</div><div class="flow-line"><div class="flow-packet purple" style="animation-delay: 0.5s"></div></div></div><div class="flow-card border-dashed border-purple-500/50 bg-purple-900/20"><div class="flow-card-title">3. Diff Engine</div><div class="relative w-8 h-8 mx-auto my-2"><i class="fas fa-arrow-right absolute top-0 left-0 text-green-400 anim-diff-r"></i><i class="fas fa-arrow-left absolute bottom-0 right-0 text-red-400 anim-diff-l"></i></div><span class="text-[8px] text-purple-200">Detects Changes</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Alerts Admin</div><div class="flow-line"><div class="flow-packet purple" style="animation-delay: 1s"></div></div></div><div class="flow-card"><div class="flow-card-title">4. Impact</div><i class="fas fa-exclamation-triangle text-yellow-400 text-2xl my-2"></i><span class="text-[8px] text-slate-400">Flags Affected Templates</span></div></div></div></div>
                        <div id="reg-upload-wizard" class="hidden flex flex-col items-center justify-center h-full pt-10 absolute top-0 left-0 w-full bg-slate-900/95 z-50"><div class="bg-slate-800 p-8 rounded-2xl border border-purple-500/50 max-w-lg w-full shadow-2xl relative"><button onclick="cancelRegUpload()" class="absolute top-4 right-4 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button><h3 class="text-xl font-bold text-white mb-6 text-center">Upload New Regulation Version</h3><div id="reg-wiz-upload" class="text-center"><div class="border-2 border-dashed border-slate-600 rounded-xl p-8 mb-6 hover:border-purple-500 transition cursor-pointer"><i class="fas fa-file-pdf text-4xl text-slate-500 mb-2"></i><p class="text-xs text-slate-400">Drag & Drop <strong>Regulation PDF</strong> here</p></div><button onclick="runRegProcessing()" class="bg-purple-600 text-white px-6 py-2 rounded-lg text-sm w-full">Start Processing</button></div><div id="reg-wiz-processing" class="hidden text-center py-6"><i class="fas fa-microchip fa-spin text-4xl text-purple-400 mb-4"></i><h4 class="text-white font-bold">AI Analyzing Changes...</h4><div class="w-full bg-slate-700 h-2 rounded-full mt-4 mb-2 overflow-hidden"><div id="reg-progress-bar" class="bg-purple-500 h-full w-0 transition-all duration-[2000ms] ease-out"></div></div><p class="text-xs text-slate-400">Comparing against v1.2...</p></div><div id="reg-wiz-success" class="hidden text-center"><div class="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4"><i class="fas fa-check text-green-400 text-3xl"></i></div><h4 class="text-white font-bold text-lg">Analysis Complete</h4><p class="text-xs text-slate-400 mt-1 mb-6">Detected <strong>2 modifications</strong> in formulas.</p><button onclick="finishRegUpload()" class="bg-green-600 text-white px-6 py-2 rounded-lg text-sm w-full">View Diff & Confirm</button></div></div></div>
                        <div id="reg-history-view" class="hidden h-full flex flex-col"><div class="flex justify-between items-center mb-6"><div class="flex items-center gap-3"><button onclick="closeRegHistory()" class="text-xs text-slate-400 hover:text-white"><i class="fas fa-arrow-left mr-1"></i> Back to History</button><div><h3 class="text-xl font-bold text-white" id="reg-history-title">Capital Adequacy 12b</h3><p class="text-xs text-slate-400">Version History & Management</p></div></div><button onclick="startRegUpload()" class="bg-blue-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-blue-500 transition shadow-lg shadow-blue-500/20"><i class="fas fa-cloud-upload-alt mr-2"></i> Upload New Version</button></div><div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700 mb-6"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th class="w-10 text-center"><input type="checkbox"></th><th>Version</th><th>Uploaded Date</th><th>By</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr class="bg-slate-700/30"><td class="text-center"><input type="checkbox" checked disabled></td><td class="font-bold text-white">v1.2</td><td>2024-02-15</td><td>Admin</td><td><span class="text-green-400 border border-green-500/50 px-1 rounded text-[9px]">Active</span></td><td><span class="mock-btn-sm btn-blue">View</span></td></tr><tr><td class="text-center"><input type="checkbox"></td><td class="font-bold text-slate-400">v1.1</td><td>2024-01-20</td><td>User B</td><td><span class="text-slate-500 text-[9px]">Archived</span></td><td><span class="mock-btn-sm btn-blue">View</span><span class="mock-btn-sm btn-green" onclick="alert('v1.1 is now Active')">Activate</span></td></tr><tr><td class="text-center"><input type="checkbox"></td><td class="font-bold text-slate-400">v1.0</td><td>2024-01-01</td><td>Admin</td><td><span class="text-slate-500 text-[9px]">Archived</span></td><td><span class="mock-btn-sm btn-blue">View</span><span class="mock-btn-sm btn-green" onclick="alert('v1.0 is now Active')">Activate</span></td></tr></tbody></table></div><div class="bg-slate-900 border border-slate-700 p-4 rounded-xl flex justify-between items-center"><div class="text-xs text-slate-400"><i class="fas fa-info-circle mr-2 text-blue-400"></i> Select exactly two versions to compare changes.</div><button onclick="openRegDiff()" class="bg-purple-600 text-white text-xs px-6 py-2 rounded-lg hover:bg-purple-500 transition border border-purple-400">Compare Selected (2)</button></div></div>
                        <div id="reg-diff-view" class="hidden h-full flex flex-col"><div class="flex justify-between items-center mb-4"><div class="flex items-center gap-3"><button onclick="closeRegDiff()" class="text-xs text-slate-400 hover:text-white"><i class="fas fa-arrow-left mr-1"></i> Back to History</button><h3 class="text-lg font-bold text-white">Regulator Change Detection</h3></div><div class="text-xs text-slate-400">Comparing: <strong>v1.1</strong> vs <strong>v1.2 (Active)</strong></div></div><div class="flex-grow flex gap-4 overflow-hidden"><!-- Old Version --><div class="w-1/2 bg-slate-900 rounded-lg border border-slate-700 p-4 overflow-y-auto"><div class="text-[10px] text-slate-500 uppercase font-bold mb-2 border-b border-slate-700 pb-1">Version 1.1</div><p class="text-xs text-slate-400 leading-relaxed">4.1. Risk Weight Calculation.<br>The risk weight for asset class A shall be calculated as <span class="bg-red-900/50 text-red-300 px-1 rounded">12%</span> of the total exposure. This applies to all ETF instruments...</p></div><!-- New Version --><div class="w-1/2 bg-slate-900 rounded-lg border border-slate-700 p-4 overflow-y-auto"><div class="text-[10px] text-slate-500 uppercase font-bold mb-2 border-b border-slate-700 pb-1">Version 1.2 (Active)</div><p class="text-xs text-slate-400 leading-relaxed">4.1. Risk Weight Calculation.<br>The risk weight for asset class A shall be calculated as <span class="bg-green-900/50 text-green-300 px-1 rounded">15%</span> of the total exposure. This applies to all ETF instruments...</p></div></div><div class="mt-4 bg-yellow-900/20 border border-yellow-600/50 p-3 rounded flex justify-between items-center"><div class="text-xs text-yellow-200"><i class="fas fa-exclamation-triangle mr-2"></i><strong>Impact Analysis:</strong> This change affects <strong>14 Templates</strong> using the "Risk Weight" formula.</div></div></div>
                     </div>

                     <!-- PAGE: DATA SHEET -->
                     <div id="ui-page-datasheet" class="hidden">
                        <div id="ds-view-list"><div class="flex justify-between items-center mb-6"><h3 class="text-xl font-bold text-white">Available Data Sheets</h3><div class="flex gap-2"><input type="text" placeholder="Search..." class="bg-slate-800 border border-slate-600 rounded px-3 py-1 text-xs text-white w-40"><button class="bg-blue-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-blue-500 transition shadow-lg shadow-blue-500/20"><i class="fas fa-upload mr-2"></i> Upload New</button></div></div><div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th>File Name</th><th>Linked Template</th><th>Last Updated</th><th>Updated By</th><th>Actions</th></tr></thead><tbody><tr><td class="font-bold text-white"><i class="fas fa-file-excel text-green-500 mr-2"></i> ETF_Data_Master.xlsx</td><td>ETF Monthly V1</td><td>2024-10-25</td><td>Analyst A</td><td><span class="mock-btn-sm btn-blue" onclick="openDataSheet('ETF_Data_Master.xlsx')">View Data</span></td></tr><tr><td class="font-bold text-white"><i class="fas fa-file-excel text-green-500 mr-2"></i> Bond_Yields_Q3.xlsx</td><td>Bond Summary V2</td><td>2024-10-20</td><td>Admin</td><td><span class="mock-btn-sm btn-blue" onclick="openDataSheet('Bond_Yields_Q3.xlsx')">View Data</span></td></tr><tr><td class="font-bold text-white"><i class="fas fa-file-excel text-green-500 mr-2"></i> TASE_Raw_Export.xlsx</td><td>TASE Weekly</td><td>2024-10-18</td><td>Analyst B</td><td><span class="mock-btn-sm btn-blue" onclick="openDataSheet('TASE_Raw_Export.xlsx')">View Data</span></td></tr></tbody></table></div><div class="border border-green-500/30 bg-green-900/10 rounded-2xl p-6 mt-8"><h4 class="text-green-400 font-bold text-xs uppercase mb-4 tracking-widest text-center">Flow: Data Integration</h4><div class="flex items-start gap-0 overflow-x-auto pb-4 justify-center"><div class="flow-card"><div class="flow-card-title">1. Source</div><i class="fas fa-file-csv text-slate-400 text-2xl my-2"></i><span class="text-[8px] text-slate-500">Excel / Bloomberg</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Ingest</div><div class="flow-line"><div class="flow-packet green"></div></div></div><div class="flow-card"><div class="flow-card-title">2. Validate</div><i class="fas fa-shield-alt text-green-400 text-2xl my-2"></i><span class="text-[8px] text-slate-400">Type Check</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Apply Rules</div><div class="flow-line"><div class="flow-packet green" style="animation-delay: 0.5s"></div></div></div><div class="flow-card border-dashed border-green-500/50 bg-green-900/20"><div class="flow-card-title">3. Calc Engine</div><i class="fas fa-cog fa-spin text-green-300 text-2xl my-2"></i><span class="text-[8px] text-green-200">Reg Formulas</span></div><div class="flow-arrow-container pt-6"><div class="flow-action-label">Update Grid</div><div class="flow-line"><div class="flow-packet green" style="animation-delay: 1s"></div></div></div><div class="flow-card"><div class="flow-card-title">4. Master</div><i class="fas fa-table text-blue-400 text-2xl my-2"></i><span class="text-[8px] text-slate-400">Live Sheet</span></div></div></div></div>
                        <div id="ds-view-detail" class="hidden"><div class="flex justify-between items-center mb-4"><div><button onclick="closeDataSheet()" class="text-xs text-slate-400 hover:text-white mb-1"><i class="fas fa-arrow-left mr-1"></i> Back to List</button><h3 class="text-xl font-bold text-white" id="ds-title-display">ETF_Data_Master.xlsx</h3><p class="text-xs text-slate-400">Linked Regulation: <strong>Reg 12b</strong></p></div><button onclick="toggleDataEdit()" id="btn-data-edit" class="bg-blue-600 text-white text-xs px-4 py-2 rounded-lg hover:bg-blue-500 transition border border-blue-400"><i class="fas fa-pencil-alt mr-2"></i> Edit Data</button></div><div class="bg-slate-900 border border-slate-700 rounded-lg overflow-hidden relative"><table class="ds-table"><thead><tr><th>ID</th><th>Field Name</th><th>Value (Current)</th><th>Type</th><th>Source</th></tr></thead><tbody><tr><td>001</td><td>Total Assets</td><td><input type="text" value="1,500,000" class="ds-input" readonly></td><td><span class="text-slate-400">Manual</span></td><td>User Input</td></tr><tr><td>002</td><td>Cash Flow</td><td><input type="text" value="200,000" class="ds-input" readonly></td><td><span class="text-slate-400">Manual</span></td><td>User Input</td></tr><tr class="bg-blue-900/10"><td>003</td><td>Risk Weight</td><td class="ds-cell-calc" onclick="showFormula('(Total Assets - Liabilities) * 0.15', 'Reg 12b, Section 4.2')">0.15</td><td><span class="text-blue-400"><i class="fas fa-calculator mr-1"></i> Calculated</span></td><td>Reg 12b (pg. 4)</td></tr><tr class="bg-blue-900/10"><td>004</td><td>Tax Liability</td><td class="ds-cell-calc" onclick="showFormula('(Assets * 0.20)', 'Treasury Tax Code 2024')">300,000</td><td><span class="text-blue-400"><i class="fas fa-calculator mr-1"></i> Calculated</span></td><td>(Assets * 0.2)</td></tr><tr><td>005</td><td>Fund Manager</td><td><input type="text" value="John Doe" class="ds-input" readonly></td><td><span class="text-slate-400">Manual</span></td><td>User Input</td></tr></tbody></table><div id="formula-modal" class="hidden absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-slate-800 border border-blue-500 rounded-lg p-4 shadow-2xl w-64 z-20"><div class="flex justify-between items-start mb-2"><h5 class="text-xs font-bold text-blue-400 uppercase">Formula Logic</h5><button onclick="document.getElementById('formula-modal').classList.add('hidden')" class="text-slate-400 hover:text-white"><i class="fas fa-times"></i></button></div><div class="bg-black/30 p-2 rounded text-xs font-mono text-green-400 mb-2" id="formula-text">= (A1 * 0.5)</div><div class="text-[10px] text-slate-400"><i class="fas fa-book mr-1"></i> Source: <span class="text-slate-200" id="formula-source">Regulation Doc</span></div></div></div></div>
                     </div>
                     
                     <!-- HIDDEN SUB-PAGES -->
                     <div id="ui-page-reports-month" class="hidden"><div class="flex justify-between items-center mb-6"><div class="flex items-center gap-3"><button onclick="openUiPage('dashboard')" class="text-xs text-slate-400 hover:text-white"><i class="fas fa-arrow-left mr-1"></i> Dashboard</button><h3 class="text-xl font-bold text-white">Reports: Current Month</h3></div><span class="bg-blue-900/50 text-blue-300 border border-blue-500/30 text-xs px-2 py-1 rounded">12 Records</span></div><div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700"><table class="mock-table"><thead><tr class="bg-slate-700/50"><th>Date</th><th>Report Name</th><th>Author</th><th>Status</th><th>Actions</th></tr></thead><tbody><tr><td>Oct 24</td><td class="font-bold text-white">ETF Monthly Summary</td><td>Analyst A</td><td><span class="text-green-400">Submitted</span></td><td><span class="mock-btn-sm btn-blue">View</span></td></tr><tr><td>Oct 22</td><td class="font-bold text-white">Bond Yield Q3</td><td>Analyst B</td><td><span class="text-green-400">Submitted</span></td><td><span class="mock-btn-sm btn-blue">View</span></td></tr><tr><td>Oct 20</td><td class="font-bold text-white">Weekly TASE Update</td><td>Analyst A</td><td><span class="text-green-400">Submitted</span></td><td><span class="mock-btn-sm btn-blue">View</span></td></tr></tbody></table></div></div>
                     <div id="ui-page-audit-pending" class="hidden"><div class="flex justify-between items-center mb-6"><div class="flex items-center gap-3"><button onclick="openUiPage('dashboard')" class="text-xs text-slate-400 hover:text-white"><i class="fas fa-arrow-left mr-1"></i> Dashboard</button><h3 class="text-xl font-bold text-white">Pending Audits Queue</h3></div><span class="bg-yellow-900/50 text-yellow-300 border border-yellow-500/30 text-xs px-2 py-1 rounded">3 Items</span></div><div class="space-y-4"><div class="bg-slate-800 p-4 rounded-xl border-l-4 border-yellow-500 flex justify-between items-center"><div><h4 class="text-white font-bold text-sm">Oct 2024 ETF Report</h4><p class="text-xs text-slate-400">Submitted by: Analyst A • 2 hours ago</p></div><button class="bg-yellow-600 text-white text-xs px-4 py-2 rounded hover:bg-yellow-500">Review Now</button></div><div class="bg-slate-800 p-4 rounded-xl border-l-4 border-yellow-500 flex justify-between items-center"><div><h4 class="text-white font-bold text-sm">Real Estate Fund Q3</h4><p class="text-xs text-slate-400">Submitted by: Analyst C • 5 hours ago</p></div><button class="bg-yellow-600 text-white text-xs px-4 py-2 rounded hover:bg-yellow-500">Review Now</button></div><div class="bg-slate-800 p-4 rounded-xl border-l-4 border-yellow-500 flex justify-between items-center"><div><h4 class="text-white font-bold text-sm">Tech Sector Overview</h4><p class="text-xs text-slate-400">Submitted by: Analyst B • Yesterday</p></div><button class="bg-yellow-600 text-white text-xs px-4 py-2 rounded hover:bg-yellow-500">Review Now</button></div></div></div>

                 </div>
             </div>
        </div>

        <!-- ========================================== -->
        <!-- TECH VIEW (RESTORED WITH TABLE)            -->
        <!-- ========================================== -->
        <div id="view-tech" class="hidden">
            <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-cyan-500">Technical Deep Dive: Comparison</h2>
            
            <!-- Side-by-Side Diagrams -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <!-- Option A: Python -->
                <div>
                     <div class="flex items-center gap-3 mb-4 bg-blue-900/20 p-3 rounded-lg border border-blue-500/30">
                        <div class="bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded">Option A</div>
                        <h3 class="text-lg font-bold text-white">Enterprise Scale (Python)</h3>
                     </div>
                     <!-- Diagram -->
                     <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50 mb-4 h-[420px] flex flex-col relative overflow-hidden">
                         
                         <!-- Layer 1: Client -->
                         <div class="flex justify-center mb-4 relative z-10">
                             <div class="bg-slate-900 border border-slate-600 rounded px-3 py-1 flex items-center gap-2 shadow-lg">
                                 <i class="fas fa-laptop text-blue-400"></i>
                                 <div class="text-center">
                                     <div class="text-[9px] text-slate-400 uppercase font-bold">Client</div>
                                     <div class="text-[10px] text-white">React / Vue</div>
                                 </div>
                             </div>
                         </div>

                         <!-- Connector -->
                         <div class="h-4 w-0.5 bg-blue-500/50 mx-auto mb-1"></div>

                         <!-- Layer 2: Compute Cluster -->
                         <div class="border-2 border-dashed border-blue-500/30 rounded-xl p-3 bg-blue-900/5 relative flex-grow mb-4">
                             <div class="absolute -top-2.5 left-4 bg-slate-800 text-[9px] px-2 text-blue-300 border border-blue-500/30 rounded">Backend Cluster (Docker)</div>
                             
                             <div class="flex flex-col gap-3 h-full justify-center">
                                 <!-- Gateway -->
                                 <div class="bg-slate-800 border border-blue-500 rounded p-2 text-center shadow-md">
                                     <div class="text-[10px] font-bold text-blue-200">FastAPI Gateway</div>
                                     <div class="flex justify-center gap-1 mt-1">
                                         <span class="text-[8px] bg-slate-700 px-1 rounded text-slate-300">Auth</span>
                                         <span class="text-[8px] bg-slate-700 px-1 rounded text-slate-300">Rate Limit</span>
                                     </div>
                                 </div>
                                 
                                 <div class="flex justify-center"><i class="fas fa-arrow-down text-slate-600 text-xs"></i></div>
                                 
                                 <!-- Workers -->
                                 <div class="flex gap-2">
                                     <div class="flex-1 bg-slate-800 border border-purple-500 rounded p-2 text-center relative">
                                         <div class="text-[9px] font-bold text-purple-300">AI Worker</div>
                                         <div class="text-[8px] text-slate-400 mt-1">LangChain</div>
                                         <div class="text-[8px] text-slate-400">ChromaDB</div>
                                     </div>
                                     <div class="flex-1 bg-slate-800 border border-green-500 rounded p-2 text-center relative">
                                         <div class="text-[9px] font-bold text-green-300">Calc Worker</div>
                                         <div class="text-[8px] text-slate-400 mt-1">R Script</div>
                                         <div class="text-[8px] text-slate-400">Pandas</div>
                                     </div>
                                 </div>
                             </div>
                         </div>

                         <!-- Connector -->
                         <div class="h-4 w-0.5 bg-blue-500/50 mx-auto mb-1"></div>

                         <!-- Layer 3: Persistence & External -->
                         <div class="flex justify-between items-end gap-2 relative z-10">
                             <div class="bg-orange-900/20 border border-orange-500/50 rounded p-2 flex-1 text-center">
                                 <i class="fas fa-database text-orange-400 text-sm mb-1"></i>
                                 <div class="text-[9px] font-bold text-white">PostgreSQL</div>
                             </div>
                             <div class="bg-slate-900 border border-slate-600 rounded p-2 flex-1 text-center opacity-70">
                                 <i class="fas fa-network-wired text-slate-400 text-sm mb-1"></i>
                                 <div class="text-[9px] font-bold text-white">Maya API</div>
                             </div>
                         </div>

                     </div>
                     
                     <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-700">
                        <strong class="text-blue-400 text-xs block mb-2">PROS & CONS</strong>
                        <ul class="text-xs text-slate-400 space-y-1 list-disc list-inside">
                             <li>Separate scaling for AI vs. Math.</li>
                             <li>Complex state management (Redis required).</li>
                             <li>High "Context Switching" for one developer.</li>
                        </ul>
                     </div>
                </div>

                <!-- Option B: R Native -->
                <div>
                     <div class="flex items-center gap-3 mb-4 bg-green-900/20 p-3 rounded-lg border border-green-500/30">
                        <div class="bg-green-500 text-white text-xs font-bold px-2 py-1 rounded">Option B</div>
                        <h3 class="text-lg font-bold text-white">Rapid MVP (R-Native)</h3>
                     </div>
                     
                     <!-- Rich Diagram B -->
                     <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50 mb-4 h-[420px] flex flex-col relative overflow-hidden">
                         
                         <!-- Layer 1: Client -->
                         <div class="flex justify-center mb-4 relative z-10">
                             <div class="bg-slate-900 border border-slate-600 rounded px-3 py-1 flex items-center gap-2 shadow-lg">
                                 <i class="fas fa-laptop text-green-400"></i>
                                 <div class="text-center">
                                     <div class="text-[9px] text-slate-400 uppercase font-bold">Client</div>
                                     <div class="text-[10px] text-white">R Shiny UI</div>
                                 </div>
                             </div>
                         </div>

                         <!-- Connector -->
                         <div class="h-4 w-0.5 bg-green-500/50 mx-auto mb-1"></div>

                         <!-- Layer 2: Compute Monolith -->
                         <div class="border-2 border-dashed border-green-500/30 rounded-xl p-3 bg-green-900/5 relative flex-grow mb-4">
                             <div class="absolute -top-2.5 left-4 bg-slate-800 text-[9px] px-2 text-green-300 border border-green-500/30 rounded">R Session (Monolith)</div>
                             
                             <div class="flex flex-col gap-3 h-full justify-center items-center">
                                 <!-- API & Logic Combined -->
                                 <div class="w-full bg-slate-800 border border-green-500 rounded p-3 text-center shadow-md">
                                     <div class="text-[10px] font-bold text-green-200 mb-2">Application Core</div>
                                     <div class="grid grid-cols-2 gap-2">
                                         <div class="bg-slate-700/50 p-1 rounded border border-slate-600">
                                             <div class="text-[8px] text-slate-300 font-bold">Plumber</div>
                                             <div class="text-[7px] text-slate-500">API</div>
                                         </div>
                                         <div class="bg-slate-700/50 p-1 rounded border border-slate-600">
                                             <div class="text-[8px] text-slate-300 font-bold">Future</div>
                                             <div class="text-[7px] text-slate-500">Async</div>
                                         </div>
                                         <div class="bg-slate-700/50 p-1 rounded border border-slate-600">
                                             <div class="text-[8px] text-slate-300 font-bold">httr2</div>
                                             <div class="text-[7px] text-slate-500">Requests</div>
                                         </div>
                                         <div class="bg-slate-700/50 p-1 rounded border border-slate-600">
                                             <div class="text-[8px] text-slate-300 font-bold">Targets</div>
                                             <div class="text-[7px] text-slate-500">Pipeline</div>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </div>

                         <!-- Connector -->
                         <div class="h-4 w-0.5 bg-green-500/50 mx-auto mb-1"></div>

                         <!-- Layer 3: Persistence & External -->
                         <div class="grid grid-cols-3 gap-2 relative z-10">
                             <!-- DB ICON -->
                             <div class="bg-orange-900/20 border border-orange-500/50 rounded p-2 text-center">
                                 <i class="fas fa-database text-orange-400 text-sm mb-1"></i>
                                 <div class="text-[8px] font-bold text-white">Supabase</div>
                             </div>
                             <!-- EXT API 1 -->
                             <div class="bg-purple-900/20 border border-purple-500/50 rounded p-2 text-center">
                                 <i class="fas fa-brain text-purple-400 text-sm mb-1"></i>
                                 <div class="text-[8px] font-bold text-white">OpenAI</div>
                             </div>
                             <!-- EXT API 2 -->
                             <div class="bg-slate-900 border border-slate-600 rounded p-2 text-center opacity-70">
                                 <i class="fas fa-network-wired text-slate-400 text-sm mb-1"></i>
                                 <div class="text-[8px] font-bold text-white">Maya API</div>
                             </div>
                         </div>

                     </div>

                     <div class="bg-slate-800/50 p-4 rounded-lg border border-slate-700">
                        <strong class="text-green-400 text-xs block mb-2">PROS & CONS</strong>
                        <ul class="text-xs text-slate-400 space-y-1 list-disc list-inside">
                             <li>Unified Codebase (R for everything).</li>
                             <li>Deployment is a single container.</li>
                             <li>Limited concurrency (Single threaded).</li>
                        </ul>
                     </div>
                </div>
            </div>

            <!-- Comparison Table -->
            <div class="bg-slate-800 rounded-xl overflow-hidden border border-slate-700">
                <table class="w-full text-sm text-left text-slate-400">
                    <thead class="text-xs text-slate-200 uppercase bg-slate-900">
                        <tr>
                            <th class="px-6 py-4">Metric</th>
                            <th class="px-6 py-4 text-blue-400">Option A (Python Enterprise)</th>
                            <th class="px-6 py-4 text-green-400">Option B (R-Native MVP)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Time to Market</td><td class="px-6 py-4">3 - 6 Months</td><td class="px-6 py-4 font-bold text-green-400">6 - 8 Weeks</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Cost (Dev)</td><td class="px-6 py-4">High (Need Backend Dev)</td><td class="px-6 py-4 font-bold text-green-400">Low (Solo Founder)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Cursor / AI Synergy</td><td class="px-6 py-4 text-green-400">High (Pydantic/React generation is flawless)</td><td class="px-6 py-4 text-yellow-400">Medium (R Shiny logic is harder for AI)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Talent Availability</td><td class="px-6 py-4">High (Python is common)</td><td class="px-6 py-4">Niche (R Shiny Experts)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">AI Ecosystem</td><td class="px-6 py-4">Native (First-class support)</td><td class="px-6 py-4">Wrapper (API based)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Concurrency</td><td class="px-6 py-4 font-bold text-blue-400">High (Async Native)</td><td class="px-6 py-4">Medium (Needs `future` lib)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Maintenance Overhead</td><td class="px-6 py-4">High (Multiple services)</td><td class="px-6 py-4 font-bold text-green-400">Low (Monolith)</td></tr>
                        <tr class="border-b border-slate-700"><td class="px-6 py-4 font-bold text-white">Infrastructure Cost</td><td class="px-6 py-4">Higher (More containers)</td><td class="px-6 py-4 font-bold text-green-400">Lower (Single container)</td></tr>
                        <tr class="bg-slate-700/30"><td class="px-6 py-4 font-bold text-white">VERDICT</td><td class="px-6 py-4">Build for Scale (Series A)</td><td class="px-6 py-4 font-bold text-white border-l-4 border-green-500">Build for MVP (First Client)</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- DEPLOYMENT VIEW (NEW)                      -->
        <!-- ========================================== -->
        <div id="view-deployment" class="hidden">
            <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-pink-500">Deployment Strategy Comparison</h2>
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- Option A Deployment -->
                <div class="card p-6 rounded-xl border-t-2 border-blue-500 bg-slate-900/50">
                    <div class="flex items-center gap-3 mb-3"><i class="fas fa-server text-blue-400 text-xl"></i><h4 class="font-bold text-white">Option A: Container Orchestration</h4></div>
                    <div class="text-xs text-slate-400 mb-4">For Python Microservices. Requires managing multiple interconnected containers.</div>
                    <ul class="space-y-2 text-xs text-slate-300"><li class="flex gap-2"><i class="fas fa-check text-blue-500"></i> AWS ECS / Google Cloud Run</li><li class="flex gap-2"><i class="fas fa-check text-blue-500"></i> Docker Compose (Local) -> K8s (Prod)</li><li class="flex gap-2"><i class="fas fa-check text-blue-500"></i> CI/CD Pipeline (GitHub Actions) - Cursor writes these easily.</li></ul>
                </div>
                <!-- Option B Deployment -->
                <div class="card p-6 rounded-xl border-t-2 border-green-500 bg-slate-900/50">
                    <div class="flex items-center gap-3 mb-3"><i class="fas fa-box text-green-400 text-xl"></i><h4 class="font-bold text-white">Option B: Single Container PaaS</h4></div>
                    <div class="text-xs text-slate-400 mb-4">For R-Native Monolith. Simple "Git Push" deployment.</div>
                    <ul class="space-y-2 text-xs text-slate-300"><li class="flex gap-2"><i class="fas fa-check text-green-500"></i> Railway.app / Render / DigitalOcean App Platform</li><li class="flex gap-2"><i class="fas fa-check text-green-500"></i> Single `Dockerfile` defines environment</li><li class="flex gap-2"><i class="fas fa-check text-green-500"></i> Zero-downtime deploys built-in</li></ul>
                </div>
            </div>
        </div>

        <!-- ========================================== -->
        <!-- RISK & TIMELINE VIEW (Interactive)         -->
        <!-- ========================================== -->
        <div id="view-risk" class="hidden">
            <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-blue-500">Risk Profile Comparison</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Option A Risk -->
                <div class="card p-6 rounded-xl border-t-2 border-blue-500">
                    <h3 class="text-lg font-bold text-white mb-2">Option A Risks (Python)</h3>
                    <div class="space-y-4"><div><h4 class="text-xs font-bold text-red-400 uppercase">Complexity Overload</h4><p class="text-xs text-slate-400">Managing state between React, FastAPI, Redis, and Celery creates many failure points. Debugging async issues is hard.</p></div><div><h4 class="text-xs font-bold text-orange-400 uppercase">Developer Burnout</h4><p class="text-xs text-slate-400">As a solo dev, maintaining 3 separate codebases (Frontend, Backend, Infrastructure) drastically slows feature delivery.</p></div></div>
                </div>
                <!-- Option B Risk -->
                 <div class="card p-6 rounded-xl border-t-2 border-green-500">
                    <h3 class="text-lg font-bold text-white mb-2">Option B Risks (R-Native)</h3>
                    <div class="space-y-4"><div><h4 class="text-xs font-bold text-red-400 uppercase">Bus Factor (Hiring)</h4><p class="text-xs text-slate-400">Finding R Shiny experts is much harder than finding Python/React devs. You are the single point of failure.</p></div><div><h4 class="text-xs font-bold text-orange-400 uppercase">AI Hallucination (Code)</h4><p class="text-xs text-slate-400">LLMs (like Cursor) are slightly worse at generating complex, bug-free R Shiny reactivity graphs compared to React state logic.</p></div></div>
                </div>
            </div>
        </div>
        
         <!-- ========================================== -->
        <!-- SECURITY VIEW (New)                        -->
        <!-- ========================================== -->
        <div id="view-security" class="hidden">
             <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-teal-500">Security Implementation Strategy</h2>
             <div class="grid md:grid-cols-2 gap-8">
                 <!-- Option A Security -->
                 <div class="space-y-4">
                    <div class="flex items-center gap-2 mb-2"><i class="fas fa-shield-alt text-blue-400"></i><h3 class="text-lg font-bold text-white">Option A: Middleware Security</h3></div>
                    <div class="card p-5 rounded-xl border-l-4 border-blue-500 bg-slate-900/50"><h4 class="text-sm font-bold text-blue-300 uppercase mb-2">Auth & Access</h4><p class="text-xs text-slate-400 mb-2">Handled by FastAPI Middleware (Before code runs).</p><ul class="text-xs text-slate-300 list-disc list-inside"><li><strong>Auth0 / Cognito:</strong> Enterprise-grade identity providers.</li><li><strong>OAuth2 Proxy:</strong> Standard protocol support.</li></ul></div>
                 </div>
                 <!-- Option B Security -->
                 <div class="space-y-4">
                    <div class="flex items-center gap-2 mb-2"><i class="fas fa-lock text-green-400"></i><h3 class="text-lg font-bold text-white">Option B: Integrated Security</h3></div>
                    <div class="card p-5 rounded-xl border-l-4 border-green-500 bg-slate-900/50"><h4 class="text-sm font-bold text-green-300 uppercase mb-2">Auth & Access</h4><p class="text-xs text-slate-400 mb-2">Handled by R Application Logic (Inside the code).</p><ul class="text-xs text-slate-300 list-disc list-inside"><li><strong>Supabase Auth:</strong> User management via API calls.</li><li><strong>Session Token:</strong> Stored in encrypted browser cookie.</li></ul></div>
                 </div>
             </div>
        </div>

        <!-- ========================================== -->
        <!-- COST ANALYSIS VIEW (NEW)                   -->
        <!-- ========================================== -->
        <div id="view-cost" class="hidden">
            <h2 class="text-2xl font-bold text-white mb-6 pl-2 border-l-4 border-yellow-500">Cost & Resource Analysis</h2>
            <p class="text-slate-400 mb-8 max-w-3xl">Estimated monthly burn rate and development effort for a solo founder using AI assistants.</p>

            <div class="grid md:grid-cols-2 gap-8">
                
                <!-- Option A: Python Enterprise -->
                <div class="card p-0 rounded-xl overflow-hidden border border-blue-500/30">
                    <div class="bg-blue-900/30 p-4 border-b border-blue-500/30">
                        <h3 class="text-lg font-bold text-white">Option A: Python/React</h3>
                        <div class="text-xs text-blue-300">High Complexity, High Scale</div>
                    </div>
                    <div class="p-6">
                        <div class="mb-6">
                            <div class="flex justify-between text-sm text-slate-300 mb-2">
                                <span>Infrastructure (Monthly)</span>
                                <span class="font-bold text-white">$150 - $250</span>
                            </div>
                            <div class="w-full bg-slate-700 h-2 rounded-full"><div class="bg-blue-500 h-2 rounded-full w-3/4"></div></div>
                            <p class="text-[10px] text-slate-500 mt-1">AWS/GCP (Multiple Containers + Managed DB + Redis)</p>
                        </div>
                        <div class="mb-6">
                            <div class="flex justify-between text-sm text-slate-300 mb-2">
                                <span>Development Effort</span>
                                <span class="font-bold text-white">400+ Hours</span>
                            </div>
                            <div class="w-full bg-slate-700 h-2 rounded-full"><div class="bg-blue-500 h-2 rounded-full w-full"></div></div>
                            <p class="text-[10px] text-slate-500 mt-1">High context switching. Cursor helps, but integrating 3 stacks is hard.</p>
                        </div>
                         <div class="bg-slate-800 p-3 rounded border border-slate-700">
                             <strong class="text-xs text-white block mb-1">Hidden Costs</strong>
                             <p class="text-[10px] text-slate-400">DevOps time (fixing CI/CD pipelines), dependency management across 3 repos.</p>
                         </div>
                    </div>
                </div>

                <!-- Option B: R Native -->
                <div class="card p-0 rounded-xl overflow-hidden border border-green-500/30">
                    <div class="bg-green-900/30 p-4 border-b border-green-500/30">
                        <h3 class="text-lg font-bold text-white">Option B: R-Native</h3>
                        <div class="text-xs text-green-300">Low Complexity, Medium Scale</div>
                    </div>
                    <div class="p-6">
                        <div class="mb-6">
                            <div class="flex justify-between text-sm text-slate-300 mb-2">
                                <span>Infrastructure (Monthly)</span>
                                <span class="font-bold text-white">$40 - $80</span>
                            </div>
                            <div class="w-full bg-slate-700 h-2 rounded-full"><div class="bg-green-500 h-2 rounded-full w-1/4"></div></div>
                            <p class="text-[10px] text-slate-500 mt-1">Railway (Single Container) + Supabase (Free/Pro)</p>
                        </div>
                        <div class="mb-6">
                            <div class="flex justify-between text-sm text-slate-300 mb-2">
                                <span>Development Effort</span>
                                <span class="font-bold text-white">150 Hours</span>
                            </div>
                            <div class="w-full bg-slate-700 h-2 rounded-full"><div class="bg-green-500 h-2 rounded-full w-1/3"></div></div>
                            <p class="text-[10px] text-slate-500 mt-1">Unified language. You already know R. Fast iteration.</p>
                        </div>
                         <div class="bg-slate-800 p-3 rounded border border-slate-700">
                             <strong class="text-xs text-white block mb-1">Hidden Costs</strong>
                             <p class="text-[10px] text-slate-400">Technical Debt. As user count grows >50, you might need to rewrite in Python later.</p>
                         </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="text-center text-slate-600 text-sm mt-12 mb-8 border-t border-slate-800 pt-8">
        <p>Investment SaaS MVP Strategy • Generated for Internal Review</p>
    </footer>

    <script>
        function switchView(viewName) {
            const views = ['tech', 'risk', 'security', 'deployment', 'ui-journey', 'biz-process', 'cost'];
            
            views.forEach(v => {
                const el = document.getElementById('view-' + v);
                const btn = document.getElementById('btn-' + v);
                
                if(v === viewName) {
                    if(el) {
                        el.style.display = 'block';
                        el.classList.add('fade-in');
                    }
                    if(btn) {
                        btn.classList.remove('inactive');
                        btn.classList.add('active');
                    }
                } else {
                    if(el) {
                        el.style.display = 'none';
                        el.classList.remove('fade-in');
                    }
                    if(btn) {
                        btn.classList.remove('active');
                        btn.classList.add('inactive');
                    }
                }
            });
        }

        function openUiPage(pageName) {
            const pages = ['dashboard', 'templates', 'reports', 'audit', 'datasheet', 'regulations', 'reports-month', 'audit-pending'];
            
            // Hide all sub-pages first
            pages.forEach(p => {
                const el = document.getElementById('ui-page-' + p);
                if (el) el.style.display = 'none';
                
                // Remove active class from nav, if exists
                const nav = document.getElementById('nav-' + p);
                if (nav) nav.classList.remove('active');
            });

            // Show selected page
            const targetEl = document.getElementById('ui-page-' + pageName);
            if (targetEl) {
                targetEl.style.display = 'block';
                targetEl.classList.add('fade-in');
            }
            
            // Activate specific navigation item or parent based on pageName
            if (pageName === 'reports-month') {
                 // No specific nav to highlight
            } else if (pageName === 'audit-pending') {
                 // No specific nav
            } else {
                 const targetNav = document.getElementById('nav-' + pageName);
                 if (targetNav) targetNav.classList.add('active');
            }
            
            // Reset wizard states when navigating
            const tList = document.getElementById('template-step-list');
            if(tList) tList.classList.remove('hidden');
            const tWiz = document.getElementById('template-step-wizard');
            if(tWiz) tWiz.classList.add('hidden');
            
            const rList = document.getElementById('report-step-list');
            if(rList) rList.classList.remove('hidden');
            const rWiz = document.getElementById('report-step-wizard');
            if(rWiz) rWiz.classList.add('hidden');
            
            // Reset modal
            const tHist = document.getElementById('template-history-modal');
            if(tHist) tHist.classList.add('hidden');
            
            // Reset reg diff
            const regList = document.getElementById('reg-list-view');
            const regHistory = document.getElementById('reg-history-view');
            const regDiff = document.getElementById('reg-diff-view');
            
            if(regList) regList.classList.remove('hidden');
            if(regHistory) regHistory.classList.add('hidden');
            if(regDiff) regDiff.classList.add('hidden');
            
            // Reset Reg Wizard
            const regWiz = document.getElementById('reg-upload-wizard');
            if(regWiz) regWiz.classList.add('hidden');
        }
        
        // Data Sheet Functions
        function openDataSheet(fileName) {
            document.getElementById('ds-view-list').classList.add('hidden');
            document.getElementById('ds-view-detail').classList.remove('hidden');
            document.getElementById('ds-title-display').innerText = fileName;
        }

        function closeDataSheet() {
            document.getElementById('ds-view-detail').classList.add('hidden');
            document.getElementById('ds-view-list').classList.remove('hidden');
        }

        function showFormula(formula, source) {
            const modal = document.getElementById('formula-modal');
            document.getElementById('formula-text').innerText = "= " + formula;
            document.getElementById('formula-source').innerText = source;
            modal.classList.remove('hidden');
        }

        // Data Edit Toggle
        function toggleDataEdit() {
            const btn = document.getElementById('btn-data-edit');
            const inputs = document.querySelectorAll('.ds-input');
            const isEditing = btn.innerText.includes("Save");
            
            if(!isEditing) {
                btn.innerHTML = '<i class="fas fa-save mr-2"></i> Save Changes';
                btn.classList.remove('bg-blue-600', 'hover:bg-blue-500', 'border-blue-400');
                btn.classList.add('bg-green-600', 'hover:bg-green-500', 'border-green-400');
                
                inputs.forEach(inp => {
                    inp.removeAttribute('readonly');
                    inp.classList.add('editing');
                });
            } else {
                btn.innerHTML = '<i class="fas fa-pencil-alt mr-2"></i> Edit Data';
                btn.classList.add('bg-blue-600', 'hover:bg-blue-500', 'border-blue-400');
                btn.classList.remove('bg-green-600', 'hover:bg-green-500', 'border-green-400');
                
                inputs.forEach(inp => {
                    inp.setAttribute('readonly', true);
                    inp.classList.remove('editing');
                });
            }
        }
        
        // Regulation History & Diff Functions
        function openRegHistory(docName) {
            document.getElementById('reg-list-view').classList.add('hidden');
            document.getElementById('reg-history-view').classList.remove('hidden');
            document.getElementById('reg-history-title').innerText = docName;
        }

        function closeRegHistory() {
            document.getElementById('reg-history-view').classList.add('hidden');
            document.getElementById('reg-list-view').classList.remove('hidden');
        }

        function openRegDiff() {
            document.getElementById('reg-history-view').classList.add('hidden');
            document.getElementById('reg-diff-view').classList.remove('hidden');
        }

        function closeRegDiff() {
            document.getElementById('reg-diff-view').classList.add('hidden');
            document.getElementById('reg-history-view').classList.remove('hidden');
        }
        
        // NEW REGULATION UPLOAD WIZARD LOGIC
        function startRegUpload() {
            document.getElementById('reg-upload-wizard').classList.remove('hidden');
            document.getElementById('reg-wiz-upload').classList.remove('hidden');
            document.getElementById('reg-wiz-processing').classList.add('hidden');
            document.getElementById('reg-wiz-success').classList.add('hidden');
            document.getElementById('reg-progress-bar').style.width = '0%';
        }

        function runRegProcessing() {
            document.getElementById('reg-wiz-upload').classList.add('hidden');
            document.getElementById('reg-wiz-processing').classList.remove('hidden');
            
            // Animate progress bar
            setTimeout(() => { document.getElementById('reg-progress-bar').style.width = '40%'; }, 500);
            setTimeout(() => { document.getElementById('reg-progress-bar').style.width = '75%'; }, 1500);
            setTimeout(() => { document.getElementById('reg-progress-bar').style.width = '100%'; }, 2500);
            
            // Fake delay for completion
            setTimeout(() => {
                document.getElementById('reg-wiz-processing').classList.add('hidden');
                document.getElementById('reg-wiz-success').classList.remove('hidden');
            }, 3000);
        }

        function finishRegUpload() {
            cancelRegUpload();
            // In a real app, this would refresh the list. Here we jump to diff to show the result.
            openRegDiff();
        }

        function cancelRegUpload() {
            document.getElementById('reg-upload-wizard').classList.add('hidden');
        }


        // New Template Wizard Functions
        function startTemplateWizard() {
            document.getElementById('template-step-list').classList.add('hidden');
            document.getElementById('template-step-wizard').classList.remove('hidden');
            document.getElementById('wiz-upload').classList.remove('hidden');
            document.getElementById('wiz-processing').classList.add('hidden');
            document.getElementById('wiz-success').classList.add('hidden');
            
            // Reset Progress Bar
            document.getElementById('ai-progress-bar').style.width = '0%';
        }

        function runAiAnalysis() {
            document.getElementById('wiz-upload').classList.add('hidden');
            document.getElementById('wiz-processing').classList.remove('hidden');
            
            // Animate progress bar
            setTimeout(() => { document.getElementById('ai-progress-bar').style.width = '40%'; }, 500);
            setTimeout(() => { document.getElementById('ai-progress-bar').style.width = '75%'; }, 1500);
            setTimeout(() => { document.getElementById('ai-progress-bar').style.width = '100%'; }, 2500);
            
            // Fake delay for completion
            setTimeout(() => {
                document.getElementById('wiz-processing').classList.add('hidden');
                document.getElementById('wiz-success').classList.remove('hidden');
            }, 3000);
        }

        function finishTemplateWizard() {
             cancelTemplateWizard(); // Just go back to list
             // Simulate new row added (conceptually)
        }

        function cancelTemplateWizard() {
            document.getElementById('template-step-wizard').classList.add('hidden');
            document.getElementById('template-step-list').classList.remove('hidden');
        }
        
        // Template History & Activation
        function toggleTemplateHistory() {
            const modal = document.getElementById('template-history-modal');
            if(modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
            } else {
                modal.classList.add('hidden');
            }
        }
        
        function activateTemplate(btn) {
            // Find parent row to update status
            const row = document.getElementById('draft-template-row');
            const statusCell = document.getElementById('draft-status');
            const actionsCell = document.getElementById('draft-actions');
            
            // Update UI to Active State
            statusCell.innerHTML = '<span class="text-green-400">● Active</span>';
            
            // Remove Activate button, keep others
            // Ideally re-render the cell content
            btn.remove();
            
            // Add "Use" button
            const useBtn = document.createElement('span');
            useBtn.className = 'mock-btn-sm btn-green';
            useBtn.onclick = function() { startReportWizard(); };
            useBtn.innerText = 'Use';
            actionsCell.appendChild(useBtn);
            
            alert("Template Activated Successfully!");
        }

        // New Report Wizard Functions
        function startReportWizard() {
            document.getElementById('report-step-list').classList.add('hidden');
            document.getElementById('report-step-wizard').classList.remove('hidden');
        }
        
        function finishReportWizard() {
            openUiPage('datasheet');
        }

        function cancelReportWizard() {
             document.getElementById('report-step-wizard').classList.add('hidden');
             document.getElementById('report-step-list').classList.remove('hidden');
        }
    </script>
</body>
</html>